import{r as l,g as ie,R as h}from"./index-BjajBSh7.js";import{j as m}from"./jsx-runtime-D_zvdyIk.js";import{m as te,n as ae,o as ce}from"./ThemeProvider-D9J6blKF.js";import{r as de}from"./index-D2X6w8_q.js";import{U as L,_ as oe,V as j,r as M,s as ne,e as ue,v as D,D as he,w as pe,o as p}from"./index-I9HeoSGT.js";import{c as fe}from"./async-storage-CbWkip1I.js";const K=l.createContext(null),ar=r=>{const e=l.useContext(K);return m.jsx(K.Provider,{value:r.disable?e:null,children:r.children})};function Se(r,e,t){const o=l.useRef(e??r);return te(()=>{o.current=r}),l.useCallback(t?(...s)=>{var n;return(n=o.current)==null?void 0:n.apply(null,s)}:()=>o.current,[])}function cr(r){return Se(r,me,!0)}const me=()=>{throw new Error("Cannot call an event handler while rendering.")},ge=r=>{l.startTransition(r)};typeof globalThis.__DEV__>"u"&&(globalThis.__DEV__=!1);const ve=l.createContext(1),Re=l.createContext(void 0);var Te={};const C={},F={},ye=r=>{if(Te.TAMAGUI_STACK_Z_INDEX_GLOBAL){const{stackZIndex:e,zIndex:t}=r,o=l.useId(),s=l.useMemo(()=>{if(e&&e!=="global"&&t===void 0){const n=Object.values(F).reduce((i,a)=>Math.max(i,a),0);return Math.max(e===!0?1:e,n+1)}return t??1e3},[e]);return l.useEffect(()=>{if(typeof e=="number")return F[o]=e,()=>{delete F[o]}},[e]),s}else{const{stackZIndex:e,zIndex:t}=r,o=l.useId(),s=l.useContext(ve),n=e==="global"?0:s,i=l.useContext(Re);C[n]||(C[n]={});const a=C[n],d=l.useMemo(()=>{if(typeof t=="number")return t;if(e){if(i)return i+1;const R=Object.values(a).reduce((g,T)=>Math.max(g,T),0),f=n*5e3+R+1;return typeof e=="number"?e+f:f}return 1},[n,t,e]);return l.useEffect(()=>{if(e)return a[o]=d,()=>{delete a[o]}},[d]),d}},be=r=>({stackZIndex:r.stackZIndex,zIndex:we(r.zIndex)}),we=r=>typeof r>"u"||r==="unset"?void 0:typeof r=="number"?r:ae(r,"zIndex"),dr=l.memo(r=>{var n;if(ce)return null;const e=(n=globalThis.document)==null?void 0:n.body;if(!e)return r.children;const{children:t,passThrough:o}=r,s=ye(be(r));return o?t:de.createPortal(m.jsx("span",{style:{zIndex:s,position:"fixed",inset:0,contain:"strict",pointerEvents:"none"},children:t}),e)});var U={};const Ee=typeof globalThis<"u"&&!!(globalThis._IS_FABRIC??globalThis.nativeFabricUIManager),ur=U.TAMAGUI_USE_NATIVE_PORTAL&&U.TAMAGUI_USE_NATIVE_PORTAL!=="false"?!0:!Ee,Z=new Map,_e={},Ie={},se=(r,e)=>(e in r||(r[e]=[]),r),xe=(r,e)=>(delete r[e],r),Ce=(r,e,t,o)=>{e in r||(r=se(r,e));const s=r[e].findIndex(n=>n.name===t);return s!==-1?r[e][s].node=o:r[e].push({name:t,node:o}),r},He=(r,e,t)=>{if(!(e in r))return console.info(`Failed to remove portal '${t}', '${e}' was not registered!`),r;const o=r[e].findIndex(s=>s.name===t);return o!==-1&&r[e].splice(o,1),r},ke=(r,e)=>{const{type:t}=e;switch(t){case 0:return se({...r},e.hostName);case 1:return xe({...r},e.hostName);case 2:return Ce({...r},e.hostName,e.portalName,e.node);case 3:return He({...r},e.hostName,e.portalName);default:return r}},Me=l.createContext(null),De=l.createContext(null),Pe=({rootHostName:r="root",shouldAddRootHost:e=!0,children:t})=>{const[o,s]=l.useReducer(ke,Ie),n=l.useMemo(()=>i=>{ge(()=>{s(i)})},[s]);return m.jsx(De.Provider,{value:n,children:m.jsxs(Me.Provider,{value:o,children:[t,e&&m.jsx(Ve,{name:r})]})})},Ae=l.memo(Pe);Ae.displayName="PortalProvider";const Ve=l.memo(function(r){return m.jsx(Ne,{...r})});function Ne(r){return te(()=>()=>{Z.delete(r.name)},[r.name]),m.jsx("div",{style:{display:"contents"},ref:e=>{var t;e&&(Z.set(r.name,e),(t=_e[r.name])==null||t.forEach(o=>o(e)))}})}var P={_currentlyFocusedNode:null,currentlyFocusedField(){return document.activeElement!==this._currentlyFocusedNode&&(this._currentlyFocusedNode=null),this._currentlyFocusedNode},focusTextInput(r){r!==null&&(this._currentlyFocusedNode=r,document.activeElement!==r&&L.focus(r))},blurTextInput(r){r!==null&&(this._currentlyFocusedNode=null,document.activeElement===r&&L.blur(r))}},ze=()=>{P.blurTextInput(P.currentlyFocusedField())},Oe=["onScroll","onTouchMove","onWheel","scrollEnabled","scrollEventThrottle","showsHorizontalScrollIndicator","showsVerticalScrollIndicator","style"];function G(r){return{nativeEvent:{contentOffset:{get x(){return r.target.scrollLeft},get y(){return r.target.scrollTop}},contentSize:{get height(){return r.target.scrollHeight},get width(){return r.target.scrollWidth}},layoutMeasurement:{get height(){return r.target.offsetHeight},get width(){return r.target.offsetWidth}}},timeStamp:Date.now()}}function Fe(r,e){var t=Date.now()-r;return e>0&&t>=e}var We=l.forwardRef((r,e)=>{var t=r.onScroll,o=r.onTouchMove,s=r.onWheel,n=r.scrollEnabled,i=n===void 0?!0:n,a=r.scrollEventThrottle,d=a===void 0?0:a,R=r.showsHorizontalScrollIndicator,f=r.showsVerticalScrollIndicator,g=r.style,T=oe(r,Oe),S=l.useRef({isScrolling:!1,scrollLastTick:0}),y=l.useRef(null),E=l.useRef(null);function b(c){return le=>{i&&c&&c(le)}}function _(c){c.stopPropagation(),c.target===E.current&&(c.persist(),y.current!=null&&clearTimeout(y.current),y.current=setTimeout(()=>{O(c)},100),S.current.isScrolling?Fe(S.current.scrollLastTick,d)&&v(c):I(c))}function I(c){S.current.isScrolling=!0,v(c)}function v(c){S.current.scrollLastTick=Date.now(),t&&t(G(c))}function O(c){S.current.isScrolling=!1,t&&t(G(c))}var x=R===!1||f===!1;return l.createElement(j,M({},T,{onScroll:_,onTouchMove:b(o),onWheel:b(s),ref:ue(E,e),style:[g,!i&&$.scrollDisabled,x&&$.hideScrollbar]}))}),$=ne.create({scrollDisabled:{overflowX:"hidden",overflowY:"hidden",touchAction:"none"},hideScrollbar:{scrollbarWidth:"none"}}),W,Q;function qe(){if(Q)return W;Q=1;function r(t){return function(){return t}}var e=function(){};return e.thatReturns=r,e.thatReturnsFalse=r(!1),e.thatReturnsTrue=r(!0),e.thatReturnsNull=r(null),e.thatReturnsThis=function(){return this},e.thatReturnsArgument=function(t){return t},W=e,W}var q,Y;function Le(){if(Y)return q;Y=1;var r=qe(),e=r;return q=e,q}var je=Le();const Be=ie(je);var Ke=["contentContainerStyle","horizontal","onContentSizeChange","refreshControl","stickyHeaderIndices","pagingEnabled","forwardedRef","keyboardDismissMode","onScroll","centerContent"],X={},Ue=16;class Ze extends h.Component{constructor(){super(...arguments),this._scrollNodeRef=null,this._innerViewRef=null,this.isTouching=!1,this.lastMomentumScrollBeginTime=0,this.lastMomentumScrollEndTime=0,this.observedScrollSinceBecomingResponder=!1,this.becameResponderWhileAnimating=!1,this.scrollResponderHandleScrollShouldSetResponder=()=>this.isTouching,this.scrollResponderHandleStartShouldSetResponderCapture=e=>this.scrollResponderIsAnimating(),this.scrollResponderHandleTerminationRequest=()=>!this.observedScrollSinceBecomingResponder,this.scrollResponderHandleTouchEnd=e=>{var t=e.nativeEvent;this.isTouching=t.touches.length!==0,this.props.onTouchEnd&&this.props.onTouchEnd(e)},this.scrollResponderHandleResponderRelease=e=>{this.props.onResponderRelease&&this.props.onResponderRelease(e);var t=P.currentlyFocusedField();!this.props.keyboardShouldPersistTaps&&t!=null&&e.target!==t&&!this.observedScrollSinceBecomingResponder&&!this.becameResponderWhileAnimating&&(this.props.onScrollResponderKeyboardDismissed&&this.props.onScrollResponderKeyboardDismissed(e),P.blurTextInput(t))},this.scrollResponderHandleScroll=e=>{this.observedScrollSinceBecomingResponder=!0,this.props.onScroll&&this.props.onScroll(e)},this.scrollResponderHandleResponderGrant=e=>{this.observedScrollSinceBecomingResponder=!1,this.props.onResponderGrant&&this.props.onResponderGrant(e),this.becameResponderWhileAnimating=this.scrollResponderIsAnimating()},this.scrollResponderHandleScrollBeginDrag=e=>{this.props.onScrollBeginDrag&&this.props.onScrollBeginDrag(e)},this.scrollResponderHandleScrollEndDrag=e=>{this.props.onScrollEndDrag&&this.props.onScrollEndDrag(e)},this.scrollResponderHandleMomentumScrollBegin=e=>{this.lastMomentumScrollBeginTime=Date.now(),this.props.onMomentumScrollBegin&&this.props.onMomentumScrollBegin(e)},this.scrollResponderHandleMomentumScrollEnd=e=>{this.lastMomentumScrollEndTime=Date.now(),this.props.onMomentumScrollEnd&&this.props.onMomentumScrollEnd(e)},this.scrollResponderHandleTouchStart=e=>{this.isTouching=!0,this.props.onTouchStart&&this.props.onTouchStart(e)},this.scrollResponderHandleTouchMove=e=>{this.props.onTouchMove&&this.props.onTouchMove(e)},this.scrollResponderIsAnimating=()=>{var e=Date.now(),t=e-this.lastMomentumScrollEndTime,o=t<Ue||this.lastMomentumScrollEndTime<this.lastMomentumScrollBeginTime;return o},this.scrollResponderScrollTo=(e,t,o)=>{if(typeof e=="number")console.warn("`scrollResponderScrollTo(x, y, animated)` is deprecated. Use `scrollResponderScrollTo({x: 5, y: 5, animated: true})` instead.");else{var s=e||X;e=s.x,t=s.y,o=s.animated}var n=this.getScrollableNode(),i=e||0,a=t||0;n!=null&&(typeof n.scroll=="function"?n.scroll({top:a,left:i,behavior:o?"smooth":"auto"}):(n.scrollLeft=i,n.scrollTop=a))},this.scrollResponderZoomTo=(e,t)=>{D("zoomToRect is not implemented")},this.scrollResponderScrollNativeHandleToKeyboard=(e,t,o)=>{this.additionalScrollOffset=t||0,this.preventNegativeScrollOffset=!!o,L.measureLayout(e,this.getInnerViewNode(),this.scrollResponderTextInputFocusError,this.scrollResponderInputMeasureAndScrollToKeyboard)},this.scrollResponderInputMeasureAndScrollToKeyboard=(e,t,o,s)=>{var n=he.get("window").height;this.keyboardWillOpenTo&&(n=this.keyboardWillOpenTo.endCoordinates.screenY);var i=t-n+s+this.additionalScrollOffset;this.preventNegativeScrollOffset&&(i=Math.max(0,i)),this.scrollResponderScrollTo({x:0,y:i,animated:!0}),this.additionalOffset=0,this.preventNegativeScrollOffset=!1},this.scrollResponderKeyboardWillShow=e=>{this.keyboardWillOpenTo=e,this.props.onKeyboardWillShow&&this.props.onKeyboardWillShow(e)},this.scrollResponderKeyboardWillHide=e=>{this.keyboardWillOpenTo=null,this.props.onKeyboardWillHide&&this.props.onKeyboardWillHide(e)},this.scrollResponderKeyboardDidShow=e=>{e&&(this.keyboardWillOpenTo=e),this.props.onKeyboardDidShow&&this.props.onKeyboardDidShow(e)},this.scrollResponderKeyboardDidHide=e=>{this.keyboardWillOpenTo=null,this.props.onKeyboardDidHide&&this.props.onKeyboardDidHide(e)},this.flashScrollIndicators=()=>{this.scrollResponderFlashScrollIndicators()},this.getScrollResponder=()=>this,this.getScrollableNode=()=>this._scrollNodeRef,this.getInnerViewRef=()=>this._innerViewRef,this.getInnerViewNode=()=>this._innerViewRef,this.getNativeScrollRef=()=>this._scrollNodeRef,this.scrollTo=(e,t,o)=>{if(typeof e=="number")console.warn("`scrollTo(y, x, animated)` is deprecated. Use `scrollTo({x: 5, y: 5, animated: true})` instead.");else{var s=e||X;t=s.x,e=s.y,o=s.animated}this.scrollResponderScrollTo({x:t||0,y:e||0,animated:o!==!1})},this.scrollToEnd=e=>{var t=(e&&e.animated)!==!1,o=this.props.horizontal,s=this.getScrollableNode(),n=o?s.scrollWidth:0,i=o?0:s.scrollHeight;this.scrollResponderScrollTo({x:n,y:i,animated:t})},this._handleContentOnLayout=e=>{var t=e.nativeEvent.layout,o=t.width,s=t.height;this.props.onContentSizeChange(o,s)},this._handleScroll=e=>{this.props.keyboardDismissMode==="on-drag"&&ze(),this.scrollResponderHandleScroll(e)},this._setInnerViewRef=e=>{this._innerViewRef=e},this._setScrollNodeRef=e=>{this._scrollNodeRef=e,e!=null&&(e.getScrollResponder=this.getScrollResponder,e.getInnerViewNode=this.getInnerViewNode,e.getInnerViewRef=this.getInnerViewRef,e.getNativeScrollRef=this.getNativeScrollRef,e.getScrollableNode=this.getScrollableNode,e.scrollTo=this.scrollTo,e.scrollToEnd=this.scrollToEnd,e.flashScrollIndicators=this.flashScrollIndicators,e.scrollResponderZoomTo=this.scrollResponderZoomTo,e.scrollResponderScrollNativeHandleToKeyboard=this.scrollResponderScrollNativeHandleToKeyboard);var t=pe(this.props.forwardedRef);t(e)}}scrollResponderHandleStartShouldSetResponder(){return!1}scrollResponderHandleResponderReject(){Be(!1,"ScrollView doesn't take rejection well - scrolls anyway")}scrollResponderFlashScrollIndicators(){}scrollResponderTextInputFocusError(e){console.error("Error measuring text field: ",e)}render(){var e=this.props,t=e.contentContainerStyle,o=e.horizontal,s=e.onContentSizeChange,n=e.refreshControl,i=e.stickyHeaderIndices,a=e.pagingEnabled;e.forwardedRef,e.keyboardDismissMode,e.onScroll;var d=e.centerContent,R=oe(e,Ke),f={};s&&(f={onLayout:this._handleContentOnLayout});var g=!o&&Array.isArray(i),T=g||a?h.Children.map(this.props.children,(v,O)=>{var x=g&&i.indexOf(O)>-1;return v!=null&&(x||a)?h.createElement(j,{style:[x&&u.stickyHeader,a&&u.pagingEnabledChild]},v):v}):this.props.children,S=h.createElement(j,M({},f,{children:T,collapsable:!1,ref:this._setInnerViewRef,style:[o&&u.contentContainerHorizontal,d&&u.contentContainerCenterContent,t]})),y=o?u.baseHorizontal:u.baseVertical,E=o?u.pagingEnabledHorizontal:u.pagingEnabledVertical,b=p(p({},R),{},{style:[y,a&&E,this.props.style],onTouchStart:this.scrollResponderHandleTouchStart,onTouchMove:this.scrollResponderHandleTouchMove,onTouchEnd:this.scrollResponderHandleTouchEnd,onScrollBeginDrag:this.scrollResponderHandleScrollBeginDrag,onScrollEndDrag:this.scrollResponderHandleScrollEndDrag,onMomentumScrollBegin:this.scrollResponderHandleMomentumScrollBegin,onMomentumScrollEnd:this.scrollResponderHandleMomentumScrollEnd,onStartShouldSetResponder:this.scrollResponderHandleStartShouldSetResponder,onStartShouldSetResponderCapture:this.scrollResponderHandleStartShouldSetResponderCapture,onScrollShouldSetResponder:this.scrollResponderHandleScrollShouldSetResponder,onScroll:this._handleScroll,onResponderGrant:this.scrollResponderHandleResponderGrant,onResponderTerminationRequest:this.scrollResponderHandleTerminationRequest,onResponderTerminate:this.scrollResponderHandleTerminate,onResponderRelease:this.scrollResponderHandleResponderRelease,onResponderReject:this.scrollResponderHandleResponderReject}),_=We;D(_!==void 0,"ScrollViewClass must not be undefined");var I=h.createElement(_,M({},b,{ref:this._setScrollNodeRef}),S);return n?h.cloneElement(n,{style:b.style},I):I}}var J={flexGrow:1,flexShrink:1,transform:"translateZ(0)",WebkitOverflowScrolling:"touch"},u=ne.create({baseVertical:p(p({},J),{},{flexDirection:"column",overflowX:"hidden",overflowY:"auto"}),baseHorizontal:p(p({},J),{},{flexDirection:"row",overflowX:"auto",overflowY:"hidden"}),contentContainerHorizontal:{flexDirection:"row"},contentContainerCenterContent:{justifyContent:"center",flexGrow:1},stickyHeader:{position:"sticky",top:0,zIndex:10},pagingEnabledHorizontal:{scrollSnapType:"x mandatory"},pagingEnabledVertical:{scrollSnapType:"y mandatory"},pagingEnabledChild:{scrollSnapAlign:"start"}}),Ge=h.forwardRef((r,e)=>h.createElement(Ze,M({},r,{forwardedRef:e})));Ge.displayName="ScrollView";class $e{constructor(e){var t=e.onMoreTasks;this._onMoreTasks=t,this._queueStack=[{tasks:[],popable:!0}]}enqueue(e){this._getCurrentQueue().push(e)}enqueueTasks(e){e.forEach(t=>this.enqueue(t))}cancelTasks(e){this._queueStack=this._queueStack.map(t=>p(p({},t),{},{tasks:t.tasks.filter(o=>e.indexOf(o)===-1)})).filter((t,o)=>t.tasks.length>0||o===0)}hasTasksToProcess(){return this._getCurrentQueue().length>0}processNext(){var e=this._getCurrentQueue();if(e.length){var t=e.shift();try{typeof t=="object"&&t.gen?this._genPromise(t):typeof t=="object"&&t.run?t.run():(D(typeof t=="function",`Expected Function, SimpleTask, or PromiseTask, but got:
`+JSON.stringify(t,null,2)),t())}catch(o){throw o.message="TaskQueue: Error with task "+(t.name||"")+": "+o.message,o}}}_getCurrentQueue(){var e=this._queueStack.length-1,t=this._queueStack[e];return t.popable&&t.tasks.length===0&&e>0?(this._queueStack.pop(),this._getCurrentQueue()):t.tasks}_genPromise(e){var t=this._queueStack.push({tasks:[],popable:!1}),o=t-1,s=this._queueStack[o];e.gen().then(()=>{s.popable=!0,this.hasTasksToProcess()&&this._onMoreTasks()}).catch(n=>{setTimeout(()=>{throw n.message="TaskQueue: Error resolving Promise in task "+e.name+": "+n.message,n},0)})}}class Qe{constructor(){this._registry={}}addListener(e,t,o){var s=Ye(this._registry,e),n={context:o,listener:t,remove(){s.delete(n)}};return s.add(n),n}emit(e){var t=this._registry[e];if(t!=null){for(var o=arguments.length,s=new Array(o>1?o-1:0),n=1;n<o;n++)s[n-1]=arguments[n];for(var i=0,a=[...t];i<a.length;i++){var d=a[i];d.listener.apply(d.context,s)}}}removeAllListeners(e){e==null?this._registry={}:delete this._registry[e]}listenerCount(e){var t=this._registry[e];return t==null?0:t.size}}function Ye(r,e){var t=r[e];return t==null&&(t=new Set,r[e]=t),t}var Xe=function(e,t){return setTimeout(()=>{var o=Date.now();e({didTimeout:!1,timeRemaining(){return Math.max(0,50-(Date.now()-o))}})},1)},Je=fe&&typeof window.requestIdleCallback<"u",er=Je?window.requestIdleCallback:Xe,A=new Qe,ee={Events:{interactionStart:"interactionStart",interactionComplete:"interactionComplete"},runAfterInteractions(r){var e=[],t=new Promise(o=>{w(),r&&e.push(r),e.push({run:o,name:"resolve "+(r&&r.name||"?")}),N.enqueueTasks(e)});return{then:t.then.bind(t),done:t.then.bind(t),cancel:()=>{N.cancelTasks(e)}}},createInteractionHandle(){w();var r=++rr;return V.add(r),r},clearInteractionHandle(r){D(!!r,"Must provide a handle to clear."),w(),V.delete(r),B.add(r)},addListener:A.addListener.bind(A),setDeadline(r){z=r}},H=new Set,V=new Set,B=new Set,N=new $e({onMoreTasks:w}),k=0,rr=0,z=-1;function w(){k||(z>0?k=setTimeout(re):k=er(re))}function re(){k=0;var r=H.size;V.forEach(o=>H.add(o)),B.forEach(o=>H.delete(o));var e=H.size;if(r!==0&&e===0?A.emit(ee.Events.interactionComplete):r===0&&e!==0&&A.emit(ee.Events.interactionStart),e===0){for(var t=Date.now();N.hasTasksToProcess();)if(N.processNext(),z>0&&Date.now()-t>=z){w();break}}V.clear(),B.clear()}export{Qe as E,Ge as F,ee as I,Ae as P,ar as R,P as T,ur as U,ve as Z,K as a,Re as b,Z as c,Ve as d,dr as e,Se as f,_e as p,we as r,ge as s,cr as u};
